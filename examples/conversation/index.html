<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolyBiz AI - Conversation Practice ‰ºöËØùÁªÉ‰π†</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh; color: #fff; padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #888; margin-bottom: 20px; }
        .card {
            background: rgba(255,255,255,0.05); border-radius: 15px;
            padding: 25px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        /* Scenarios */
        .scenarios-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px; margin-bottom: 20px;
        }
        .scenario-card {
            padding: 20px; background: rgba(255,255,255,0.05);
            border: 2px solid transparent; border-radius: 12px;
            cursor: pointer; transition: all 0.3s; text-align: center;
        }
        .scenario-card:hover { border-color: #60a5fa; transform: translateY(-2px); }
        .scenario-card.selected { border-color: #3b82f6; background: rgba(59,130,246,0.2); }
        .scenario-icon { font-size: 2.5em; margin-bottom: 10px; }
        .scenario-name { font-weight: bold; margin-bottom: 5px; }
        .scenario-desc { color: #888; font-size: 0.8em; }
        /* Chat */
        .chat-container { max-height: 400px; overflow-y: auto; margin-bottom: 20px; }
        .chat-message {
            display: flex; gap: 12px; margin-bottom: 15px;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } }
        .chat-message.user { flex-direction: row-reverse; }
        .chat-avatar {
            width: 40px; height: 40px; border-radius: 50%;
            background: rgba(59,130,246,0.3); display: flex;
            align-items: center; justify-content: center; font-size: 1.2em;
            flex-shrink: 0;
        }
        .chat-message.user .chat-avatar { background: rgba(34,197,94,0.3); }
        .chat-bubble {
            max-width: 70%; padding: 12px 18px; border-radius: 18px;
            background: rgba(255,255,255,0.1);
        }
        .chat-message.user .chat-bubble {
            background: rgba(59,130,246,0.3); border-bottom-right-radius: 5px;
        }
        .chat-message:not(.user) .chat-bubble { border-bottom-left-radius: 5px; }
        .chat-zh { font-size: 1.1em; margin-bottom: 5px; }
        .chat-pinyin { color: #fbbf24; font-size: 0.85em; margin-bottom: 3px; }
        .chat-vi { color: #888; font-size: 0.85em; }
        .chat-audio {
            background: none; border: none; cursor: pointer;
            color: #60a5fa; font-size: 1em; margin-left: 8px;
        }
        /* Response Options */
        .response-options { display: flex; flex-direction: column; gap: 10px; }
        .response-option {
            padding: 15px; border: 2px solid #333; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; text-align: left;
        }
        .response-option:hover { border-color: #60a5fa; background: rgba(96,165,250,0.1); }
        .response-option.correct { border-color: #22c55e; background: rgba(34,197,94,0.2); }
        .response-option.wrong { border-color: #ef4444; background: rgba(239,68,68,0.2); }
        .response-zh { font-size: 1.1em; margin-bottom: 3px; }
        .response-vi { color: #888; font-size: 0.85em; }
        /* Progress */
        .progress-bar { height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; margin-bottom: 15px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #3b82f6, #22c55e); border-radius: 3px; transition: width 0.3s; }
        .btn {
            padding: 12px 25px; border: none; border-radius: 10px;
            cursor: pointer; font-size: 14px; transition: all 0.2s;
        }
        .btn-primary { background: #3b82f6; color: #fff; }
        .btn-success { background: #22c55e; color: #fff; }
        .btn:hover { transform: scale(1.05); }
        .role-badge {
            display: inline-block; padding: 5px 12px; border-radius: 15px;
            font-size: 0.8em; margin-bottom: 15px;
        }
        .role-a { background: rgba(59,130,246,0.2); color: #60a5fa; }
        .role-b { background: rgba(34,197,94,0.2); color: #22c55e; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí¨ Conversation Practice ‰ºöËØùÁªÉ‰π†</h1>
        <p class="subtitle">Luy·ªán h·ªôi tho·∫°i theo t√¨nh hu·ªëng th·ª±c t·∫ø</p>
        
        <div id="scenario-screen">
            <div class="card">
                <h3 style="margin-bottom:15px;">üé≠ Ch·ªçn t√¨nh hu·ªëng</h3>
                <div class="scenarios-grid" id="scenarios-grid"></div>
            </div>
        </div>
        
        <div id="chat-screen" style="display:none;">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                    <div>
                        <span class="role-badge role-b" id="your-role">B·∫°n: Kh√°ch h√†ng</span>
                    </div>
                    <span style="color:#888;" id="turn-info">L∆∞·ª£t 1/5</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width:0%"></div>
                </div>
                <div class="chat-container" id="chat-container"></div>
                <div class="response-options" id="response-options"></div>
            </div>
        </div>
        
        <div id="complete-screen" style="display:none;">
            <div class="card" style="text-align:center;padding:40px;">
                <div style="font-size:4em;margin-bottom:20px;">üéâ</div>
                <h2>Ho√†n th√†nh h·ªôi tho·∫°i!</h2>
                <p style="color:#888;margin:15px 0;">B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng <span id="score">5</span>/5 c√¢u</p>
                <div style="display:flex;gap:15px;justify-content:center;margin-top:20px;">
                    <button class="btn btn-primary" onclick="backToScenarios()">‚Üê Ch·ªçn t√¨nh hu·ªëng kh√°c</button>
                    <button class="btn btn-success" onclick="replayScenario()">üîÑ L√†m l·∫°i</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SCENARIOS = {
            restaurant: {
                name: 'Nh√† h√†ng', icon: 'üçú', desc: 'G·ªçi m√≥n, thanh to√°n',
                roleA: 'Nh√¢n vi√™n', roleB: 'Kh√°ch h√†ng',
                dialogue: [
                    { speaker: 'A', zh: 'Ê¨¢ËøéÂÖâ‰∏¥ÔºÅËØ∑ÈóÆÂá†‰ΩçÔºü', pinyin: 'HuƒÅny√≠ng guƒÅngl√≠n! Q«êngw√®n j«ê w√®i?', vi: 'Ch√†o m·ª´ng qu√Ω kh√°ch! Xin h·ªèi m·∫•y ng∆∞·ªùi ·∫°?' },
                    { speaker: 'B', zh: '‰∏§‰Ωç„ÄÇ', pinyin: 'Li«éng w√®i.', vi: 'Hai ng∆∞·ªùi.', options: [
                        { zh: '‰∏§‰Ωç„ÄÇ', vi: 'Hai ng∆∞·ªùi.', correct: true },
                        { zh: 'ÊàëË¶ÅÂêÉÈ•≠„ÄÇ', vi: 'T√¥i mu·ªën ƒÉn c∆°m.', correct: false },
                        { zh: 'Â§öÂ∞ëÈí±Ôºü', vi: 'Bao nhi√™u ti·ªÅn?', correct: false }
                    ]},
                    { speaker: 'A', zh: 'Â•ΩÁöÑÔºåËØ∑Ë∑üÊàëÊù•„ÄÇËøôÊòØËèúÂçï„ÄÇ', pinyin: 'H«éo de, q«êng gƒìn w«í l√°i. Zh√® sh√¨ c√†idƒÅn.', vi: 'V√¢ng, xin m·ªùi ƒëi theo t√¥i. ƒê√¢y l√† menu.' },
                    { speaker: 'B', zh: 'ËØ∑ÁªôÊàë‰∏ÄÁ¢óÁâõËÇâÈù¢„ÄÇ', pinyin: 'Q«êng gƒõi w«í y√¨ w«én ni√∫r√≤u mi√†n.', vi: 'Cho t√¥i m·ªôt b√°t m√¨ b√≤.', options: [
                        { zh: 'ËØ∑ÁªôÊàë‰∏ÄÁ¢óÁâõËÇâÈù¢„ÄÇ', vi: 'Cho t√¥i m·ªôt b√°t m√¨ b√≤.', correct: true },
                        { zh: 'Êàë‰∏çÈ•ø„ÄÇ', vi: 'T√¥i kh√¥ng ƒë√≥i.', correct: false },
                        { zh: 'ÂÜçËßÅÔºÅ', vi: 'T·∫°m bi·ªát!', correct: false }
                    ]},
                    { speaker: 'A', zh: 'Â•ΩÁöÑÔºåËøòË¶ÅÂà´ÁöÑÂêóÔºü', pinyin: 'H«éo de, h√°i y√†o bi√© de ma?', vi: 'V√¢ng, c√≤n c·∫ßn g√¨ n·ªØa kh√¥ng?' },
                    { speaker: 'B', zh: 'ÂÜçÊù•‰∏ÄÊùØËå∂ÔºåË∞¢Ë∞¢„ÄÇ', pinyin: 'Z√†i l√°i y√¨ bƒìi ch√°, xi√®xie.', vi: 'Th√™m m·ªôt ly tr√† n·ªØa, c·∫£m ∆°n.', options: [
                        { zh: 'ÂÜçÊù•‰∏ÄÊùØËå∂ÔºåË∞¢Ë∞¢„ÄÇ', vi: 'Th√™m m·ªôt ly tr√†, c·∫£m ∆°n.', correct: true },
                        { zh: 'ÊàëË¶ÅÂõûÂÆ∂„ÄÇ', vi: 'T√¥i mu·ªën v·ªÅ nh√†.', correct: false },
                        { zh: '‰Ω†Â•ΩÔºÅ', vi: 'Xin ch√†o!', correct: false }
                    ]},
                    { speaker: 'A', zh: '‰∏ÄÂÖ±‰∏âÂçÅ‰∫îÂùó„ÄÇ', pinyin: 'Y√≠g√≤ng sƒÅnsh√≠w«î ku√†i.', vi: 'T·ªïng c·ªông 35 t·ªá.' },
                    { speaker: 'B', zh: 'ÂèØ‰ª•Áî®ÂæÆ‰ø°ÊîØ‰ªòÂêóÔºü', pinyin: 'Kƒõy«ê y√≤ng Wƒìix√¨n zhƒ´f√π ma?', vi: 'C√≥ th·ªÉ d√πng WeChat Pay kh√¥ng?', options: [
                        { zh: 'ÂèØ‰ª•Áî®ÂæÆ‰ø°ÊîØ‰ªòÂêóÔºü', vi: 'C√≥ th·ªÉ d√πng WeChat Pay kh√¥ng?', correct: true },
                        { zh: 'Â§™Ë¥µ‰∫ÜÔºÅ', vi: 'ƒê·∫Øt qu√°!', correct: false },
                        { zh: 'ÊàëÊ≤°ÊúâÈí±„ÄÇ', vi: 'T√¥i kh√¥ng c√≥ ti·ªÅn.', correct: false }
                    ]},
                    { speaker: 'A', zh: 'ÂèØ‰ª•ÁöÑ„ÄÇË∞¢Ë∞¢ÔºåÊ¨¢Ëøé‰∏ãÊ¨°ÂÖâ‰∏¥ÔºÅ', pinyin: 'Kƒõy«ê de. Xi√®xie, huƒÅny√≠ng xi√† c√¨ guƒÅngl√≠n!', vi: 'ƒê∆∞·ª£c ·∫°. C·∫£m ∆°n, h·∫πn g·∫∑p l·∫°i!' },
                ]
            },
            shopping: {
                name: 'Mua s·∫Øm', icon: 'üõçÔ∏è', desc: 'H·ªèi gi√°, m·∫∑c c·∫£',
                roleA: 'Ng∆∞·ªùi b√°n', roleB: 'Kh√°ch mua',
                dialogue: [
                    { speaker: 'A', zh: '‰Ω†Â•ΩÔºåÊÉ≥‰π∞‰ªÄ‰πàÔºü', pinyin: 'N«ê h«éo, xi«éng m«éi sh√©nme?', vi: 'Xin ch√†o, b·∫°n mu·ªën mua g√¨?' },
                    { speaker: 'B', zh: 'Ëøô‰ª∂Ë°£ÊúçÂ§öÂ∞ëÈí±Ôºü', pinyin: 'Zh√® ji√†n yƒ´fu du≈çshao qi√°n?', vi: 'C√°i √°o n√†y bao nhi√™u ti·ªÅn?', options: [
                        { zh: 'Ëøô‰ª∂Ë°£ÊúçÂ§öÂ∞ëÈí±Ôºü', vi: 'C√°i √°o n√†y bao nhi√™u ti·ªÅn?', correct: true },
                        { zh: 'Êàë‰∏çË¶Å„ÄÇ', vi: 'T√¥i kh√¥ng c·∫ßn.', correct: false },
                        { zh: 'Â§™Â•Ω‰∫ÜÔºÅ', vi: 'Tuy·ªát qu√°!', correct: false }
                    ]},
                    { speaker: 'A', zh: '‰∏§ÁôæÂùó„ÄÇ', pinyin: 'Li«éng b«éi ku√†i.', vi: '200 t·ªá.' },
                    { speaker: 'B', zh: 'Â§™Ë¥µ‰∫ÜÔºå‰æøÂÆú‰∏ÄÁÇπÂêß„ÄÇ', pinyin: 'T√†i gu√¨ le, pi√°nyi y√¨di«én ba.', vi: 'ƒê·∫Øt qu√°, r·∫ª h∆°n ch√∫t ƒëi.', options: [
                        { zh: 'Â§™Ë¥µ‰∫ÜÔºå‰æøÂÆú‰∏ÄÁÇπÂêß„ÄÇ', vi: 'ƒê·∫Øt qu√°, r·∫ª h∆°n ch√∫t ƒëi.', correct: true },
                        { zh: 'Â•ΩÁöÑÔºåÊàë‰π∞„ÄÇ', vi: 'ƒê∆∞·ª£c, t√¥i mua.', correct: false },
                        { zh: 'ÂÜçËßÅÔºÅ', vi: 'T·∫°m bi·ªát!', correct: false }
                    ]},
                    { speaker: 'A', zh: '‰∏ÄÁôæ‰∫îÊÄé‰πàÊ†∑Ôºü', pinyin: 'Y√¨b«éi w«î zƒõnmey√†ng?', vi: '150 ƒë∆∞·ª£c kh√¥ng?' },
                    { speaker: 'B', zh: 'Â•ΩÔºåÊàëË¶ÅËøô‰ª∂„ÄÇ', pinyin: 'H«éo, w«í y√†o zh√® ji√†n.', vi: 'ƒê∆∞·ª£c, t√¥i l·∫•y c√°i n√†y.', options: [
                        { zh: 'Â•ΩÔºåÊàëË¶ÅËøô‰ª∂„ÄÇ', vi: 'ƒê∆∞·ª£c, t√¥i l·∫•y c√°i n√†y.', correct: true },
                        { zh: 'ËøòÊòØÂ§™Ë¥µ„ÄÇ', vi: 'V·∫´n c√≤n ƒë·∫Øt.', correct: false },
                        { zh: 'Êàë‰∏çÂñúÊ¨¢„ÄÇ', vi: 'T√¥i kh√¥ng th√≠ch.', correct: false }
                    ]},
                ]
            },
            taxi: {
                name: 'ƒêi taxi', icon: 'üöï', desc: 'G·ªçi xe, ch·ªâ ƒë∆∞·ªùng',
                roleA: 'T√†i x·∫ø', roleB: 'H√†nh kh√°ch',
                dialogue: [
                    { speaker: 'A', zh: '‰Ω†Â•ΩÔºåÂéªÂì™ÂÑøÔºü', pinyin: 'N«ê h«éo, q√π n«ér?', vi: 'Xin ch√†o, ƒëi ƒë√¢u?' },
                    { speaker: 'B', zh: 'ËØ∑ÂéªÁÅ´ËΩ¶Á´ô„ÄÇ', pinyin: 'Q«êng q√π hu«íchƒì zh√†n.', vi: 'L√†m ∆°n ƒë·∫øn ga t√†u.', options: [
                        { zh: 'ËØ∑ÂéªÁÅ´ËΩ¶Á´ô„ÄÇ', vi: 'L√†m ∆°n ƒë·∫øn ga t√†u.', correct: true },
                        { zh: 'Êàë‰∏çÁü•ÈÅì„ÄÇ', vi: 'T√¥i kh√¥ng bi·∫øt.', correct: false },
                        { zh: 'Â§öÂ∞ëÈí±Ôºü', vi: 'Bao nhi√™u ti·ªÅn?', correct: false }
                    ]},
                    { speaker: 'A', zh: 'Â•ΩÁöÑÔºåÂ§ßÊ¶Ç‰∫åÂçÅÂàÜÈíü„ÄÇ', pinyin: 'H«éo de, d√†g√†i √®rsh√≠ fƒìnzh≈çng.', vi: 'ƒê∆∞·ª£c, kho·∫£ng 20 ph√∫t.' },
                    { speaker: 'B', zh: 'ËØ∑ÂºÄÂø´‰∏ÄÁÇπÔºåÊàëËµ∂Êó∂Èó¥„ÄÇ', pinyin: 'Q«êng kƒÅi ku√†i y√¨di«én, w«í g«én sh√≠jiƒÅn.', vi: 'L√†m ∆°n ch·∫°y nhanh h∆°n, t√¥i ƒëang v·ªôi.', options: [
                        { zh: 'ËØ∑ÂºÄÂø´‰∏ÄÁÇπÔºåÊàëËµ∂Êó∂Èó¥„ÄÇ', vi: 'L√†m ∆°n ch·∫°y nhanh h∆°n, t√¥i ƒëang v·ªôi.', correct: true },
                        { zh: 'ÊÖ¢ÊÖ¢ÂºÄ„ÄÇ', vi: 'Ch·∫°y ch·∫≠m th√¥i.', correct: false },
                        { zh: 'ÂÅúËΩ¶ÔºÅ', vi: 'D·ª´ng xe!', correct: false }
                    ]},
                    { speaker: 'A', zh: 'Âà∞‰∫ÜÔºå‰∏ÄÂÖ±ÂõõÂçÅÂùó„ÄÇ', pinyin: 'D√†o le, y√≠g√≤ng s√¨sh√≠ ku√†i.', vi: 'ƒê·∫øn r·ªìi, t·ªïng c·ªông 40 t·ªá.' },
                    { speaker: 'B', zh: 'Áªô‰Ω†‰∫îÂçÅÔºå‰∏çÁî®Êâæ‰∫Ü„ÄÇ', pinyin: 'Gƒõi n«ê w«îsh√≠, b√∫y√≤ng zh«éo le.', vi: 'ƒê∆∞a anh 50, kh√¥ng c·∫ßn th·ªëi.', options: [
                        { zh: 'Áªô‰Ω†‰∫îÂçÅÔºå‰∏çÁî®Êâæ‰∫Ü„ÄÇ', vi: 'ƒê∆∞a anh 50, kh√¥ng c·∫ßn th·ªëi.', correct: true },
                        { zh: 'Â§™Ë¥µ‰∫ÜÔºÅ', vi: 'ƒê·∫Øt qu√°!', correct: false },
                        { zh: 'ÊàëÊ≤°Â∏¶Èí±„ÄÇ', vi: 'T√¥i kh√¥ng mang ti·ªÅn.', correct: false }
                    ]},
                ]
            },
            hotel: {
                name: 'Kh√°ch s·∫°n', icon: 'üè®', desc: 'ƒê·∫∑t ph√≤ng, check-in',
                roleA: 'L·ªÖ t√¢n', roleB: 'Kh√°ch',
                dialogue: [
                    { speaker: 'A', zh: 'ÊÇ®Â•ΩÔºåËØ∑ÈóÆÊúâÈ¢ÑËÆ¢ÂêóÔºü', pinyin: 'N√≠n h«éo, q«êngw√®n y«íu y√πd√¨ng ma?', vi: 'Xin ch√†o, qu√Ω kh√°ch c√≥ ƒë·∫∑t tr∆∞·ªõc kh√¥ng?' },
                    { speaker: 'B', zh: 'ÊúâÔºåÊàëÂßìÁéã„ÄÇ', pinyin: 'Y«íu, w«í x√¨ng W√°ng.', vi: 'C√≥, t√¥i h·ªç V∆∞∆°ng.', options: [
                        { zh: 'ÊúâÔºåÊàëÂßìÁéã„ÄÇ', vi: 'C√≥, t√¥i h·ªç V∆∞∆°ng.', correct: true },
                        { zh: 'Ê≤°Êúâ„ÄÇ', vi: 'Kh√¥ng c√≥.', correct: false },
                        { zh: 'Â§öÂ∞ëÈí±Ôºü', vi: 'Bao nhi√™u ti·ªÅn?', correct: false }
                    ]},
                    { speaker: 'A', zh: 'Â•ΩÁöÑÔºåÁéãÂÖàÁîüÔºåÊÇ®ËÆ¢ÁöÑÊòØÊ†áÂáÜÈó¥Ôºå‰Ωè‰∏§Êôö„ÄÇ', pinyin: 'H«éo de, W√°ng xiƒÅnsheng, n√≠n d√¨ng de sh√¨ biƒÅozh«în jiƒÅn, zh√π li«éng w«én.', vi: 'V√¢ng, √¥ng V∆∞∆°ng, √¥ng ƒë·∫∑t ph√≤ng ti√™u chu·∫©n, ·ªü 2 ƒë√™m.' },
                    { speaker: 'B', zh: 'ÂØπÔºåËØ∑ÈóÆÊúâÊó©È§êÂêóÔºü', pinyin: 'Du√¨, q«êngw√®n y«íu z«éocƒÅn ma?', vi: 'ƒê√∫ng r·ªìi, xin h·ªèi c√≥ b·ªØa s√°ng kh√¥ng?', options: [
                        { zh: 'ÂØπÔºåËØ∑ÈóÆÊúâÊó©È§êÂêóÔºü', vi: 'ƒê√∫ng r·ªìi, xin h·ªèi c√≥ b·ªØa s√°ng kh√¥ng?', correct: true },
                        { zh: 'ÊàëË¶ÅÈÄÄÊàø„ÄÇ', vi: 'T√¥i mu·ªën tr·∫£ ph√≤ng.', correct: false },
                        { zh: 'Â§™Ë¥µ‰∫Ü„ÄÇ', vi: 'ƒê·∫Øt qu√°.', correct: false }
                    ]},
                    { speaker: 'A', zh: 'ÊúâÁöÑÔºåÊó©È§ê‰ªé‰∏ÉÁÇπÂà∞‰πùÁÇπ„ÄÇËøôÊòØÊÇ®ÁöÑÊàøÂç°ÔºåÊàøÈó¥Âú®‰∫îÊ•º„ÄÇ', pinyin: 'Y«íu de, z«éocƒÅn c√≥ng qƒ´ di«én d√†o ji«î di«én. Zh√® sh√¨ n√≠n de f√°ngk«é, f√°ngjiƒÅn z√†i w«î l√≥u.', vi: 'C√≥ ·∫°, b·ªØa s√°ng t·ª´ 7h ƒë·∫øn 9h. ƒê√¢y l√† th·∫ª ph√≤ng, ph√≤ng ·ªü t·∫ßng 5.' },
                    { speaker: 'B', zh: 'Ë∞¢Ë∞¢ÔºåWiFiÂØÜÁ†ÅÊòØÂ§öÂ∞ëÔºü', pinyin: 'Xi√®xie, WiFi m√¨m«é sh√¨ du≈çshao?', vi: 'C·∫£m ∆°n, m·∫≠t kh·∫©u WiFi l√† g√¨?', options: [
                        { zh: 'Ë∞¢Ë∞¢ÔºåWiFiÂØÜÁ†ÅÊòØÂ§öÂ∞ëÔºü', vi: 'C·∫£m ∆°n, m·∫≠t kh·∫©u WiFi l√† g√¨?', correct: true },
                        { zh: 'Êàë‰∏ç‰Ωè‰∫Ü„ÄÇ', vi: 'T√¥i kh√¥ng ·ªü n·ªØa.', correct: false },
                        { zh: 'ÂÜçËßÅÔºÅ', vi: 'T·∫°m bi·ªát!', correct: false }
                    ]},
                ]
            },
            hospital: {
                name: 'B·ªánh vi·ªán', icon: 'üè•', desc: 'Kh√°m b·ªánh, mua thu·ªëc',
                roleA: 'B√°c sƒ©', roleB: 'B·ªánh nh√¢n',
                dialogue: [
                    { speaker: 'A', zh: '‰Ω†Â•ΩÔºåÂì™Èáå‰∏çËàíÊúçÔºü', pinyin: 'N«ê h«éo, n«él«ê b√π sh≈´fu?', vi: 'Xin ch√†o, b·∫°n kh√≥ ch·ªãu ·ªü ƒë√¢u?' },
                    { speaker: 'B', zh: 'ÊàëÂ§¥ÁñºÔºåËøòÊúâÁÇπÂèëÁÉß„ÄÇ', pinyin: 'W«í t√≥u t√©ng, h√°i y«íudi«én fƒÅshƒÅo.', vi: 'T√¥i ƒëau ƒë·∫ßu, c√≤n h∆°i s·ªët.', options: [
                        { zh: 'ÊàëÂ§¥ÁñºÔºåËøòÊúâÁÇπÂèëÁÉß„ÄÇ', vi: 'T√¥i ƒëau ƒë·∫ßu, c√≤n h∆°i s·ªët.', correct: true },
                        { zh: 'ÊàëÂæàÂ•Ω„ÄÇ', vi: 'T√¥i r·∫•t kh·ªèe.', correct: false },
                        { zh: 'Â§öÂ∞ëÈí±Ôºü', vi: 'Bao nhi√™u ti·ªÅn?', correct: false }
                    ]},
                    { speaker: 'A', zh: 'ÂèëÁÉßÂá†Â§©‰∫ÜÔºü', pinyin: 'FƒÅshƒÅo j«ê tiƒÅn le?', vi: 'S·ªët m·∫•y ng√†y r·ªìi?' },
                    { speaker: 'B', zh: '‰∏§Â§©‰∫Ü„ÄÇ', pinyin: 'Li«éng tiƒÅn le.', vi: 'Hai ng√†y r·ªìi.', options: [
                        { zh: '‰∏§Â§©‰∫Ü„ÄÇ', vi: 'Hai ng√†y r·ªìi.', correct: true },
                        { zh: 'Êàë‰∏çÁü•ÈÅì„ÄÇ', vi: 'T√¥i kh√¥ng bi·∫øt.', correct: false },
                        { zh: 'Âæà‰πÖ‰∫Ü„ÄÇ', vi: 'L√¢u l·∫Øm r·ªìi.', correct: false }
                    ]},
                    { speaker: 'A', zh: 'ÊàëÁªô‰Ω†ÂºÄÁÇπËçØÔºå‰∏ÄÂ§©ÂêÉ‰∏âÊ¨°„ÄÇ', pinyin: 'W«í gƒõi n«ê kƒÅi di«én y√†o, y√¨ tiƒÅn chƒ´ sƒÅn c√¨.', vi: 'T√¥i k√™ thu·ªëc cho b·∫°n, ng√†y u·ªëng 3 l·∫ßn.' },
                    { speaker: 'B', zh: 'Â•ΩÁöÑÔºåË∞¢Ë∞¢ÂåªÁîü„ÄÇ', pinyin: 'H«éo de, xi√®xie yƒ´shƒìng.', vi: 'V√¢ng, c·∫£m ∆°n b√°c sƒ©.', options: [
                        { zh: 'Â•ΩÁöÑÔºåË∞¢Ë∞¢ÂåªÁîü„ÄÇ', vi: 'V√¢ng, c·∫£m ∆°n b√°c sƒ©.', correct: true },
                        { zh: 'Êàë‰∏çÂêÉËçØ„ÄÇ', vi: 'T√¥i kh√¥ng u·ªëng thu·ªëc.', correct: false },
                        { zh: 'ÂÜçËßÅÔºÅ', vi: 'T·∫°m bi·ªát!', correct: false }
                    ]},
                ]
            }
        };
        
        let state = { scenario: null, turn: 0, score: 0, answered: false };
        
        function renderScenarios() {
            document.getElementById('scenarios-grid').innerHTML = Object.entries(SCENARIOS).map(([id, s]) => `
                <div class="scenario-card" onclick="selectScenario('${id}')">
                    <div class="scenario-icon">${s.icon}</div>
                    <div class="scenario-name">${s.name}</div>
                    <div class="scenario-desc">${s.desc}</div>
                </div>
            `).join('');
        }
        
        function selectScenario(id) {
            state = { scenario: id, turn: 0, score: 0, answered: false };
            document.getElementById('scenario-screen').style.display = 'none';
            document.getElementById('chat-screen').style.display = 'block';
            document.getElementById('your-role').textContent = `B·∫°n: ${SCENARIOS[id].roleB}`;
            document.getElementById('chat-container').innerHTML = '';
            playTurn();
        }
        
        function playTurn() {
            const s = SCENARIOS[state.scenario];
            const dialogue = s.dialogue;
            const userTurns = dialogue.filter(d => d.speaker === 'B').length;
            const currentUserTurn = dialogue.slice(0, state.turn + 1).filter(d => d.speaker === 'B').length;
            
            document.getElementById('turn-info').textContent = `L∆∞·ª£t ${currentUserTurn}/${userTurns}`;
            document.getElementById('progress-fill').style.width = `${(currentUserTurn / userTurns) * 100}%`;
            
            if (state.turn >= dialogue.length) {
                showComplete();
                return;
            }
            
            const msg = dialogue[state.turn];
            addMessage(msg);
            
            if (msg.speaker === 'B' && msg.options) {
                showOptions(msg.options);
            } else {
                state.turn++;
                setTimeout(() => playTurn(), 1000);
            }
        }
        
        function addMessage(msg) {
            const s = SCENARIOS[state.scenario];
            const isUser = msg.speaker === 'B';
            const avatar = isUser ? 'üë§' : 'üßë‚Äçüíº';
            
            document.getElementById('chat-container').innerHTML += `
                <div class="chat-message ${isUser ? 'user' : ''}">
                    <div class="chat-avatar">${avatar}</div>
                    <div class="chat-bubble">
                        <div class="chat-zh">${msg.zh}<button class="chat-audio" onclick="speak('${msg.zh}')">üîä</button></div>
                        <div class="chat-pinyin">${msg.pinyin}</div>
                        <div class="chat-vi">${msg.vi}</div>
                    </div>
                </div>
            `;
            document.getElementById('chat-container').scrollTop = 99999;
        }
        
        function showOptions(options) {
            state.answered = false;
            const shuffled = [...options].sort(() => Math.random() - 0.5);
            document.getElementById('response-options').innerHTML = shuffled.map((opt, i) => `
                <div class="response-option" data-correct="${opt.correct}" onclick="selectResponse(this, ${opt.correct})">
                    <div class="response-zh">${opt.zh}</div>
                    <div class="response-vi">${opt.vi}</div>
                </div>
            `).join('');
        }
        
        function selectResponse(el, correct) {
            if (state.answered) return;
            state.answered = true;
            
            document.querySelectorAll('.response-option').forEach(opt => {
                if (opt.dataset.correct === 'true') opt.classList.add('correct');
                else if (opt === el && !correct) opt.classList.add('wrong');
            });
            
            if (correct) state.score++;
            
            setTimeout(() => {
                document.getElementById('response-options').innerHTML = '';
                state.turn++;
                playTurn();
            }, 1500);
        }
        
        function showComplete() {
            document.getElementById('chat-screen').style.display = 'none';
            document.getElementById('complete-screen').style.display = 'block';
            const userTurns = SCENARIOS[state.scenario].dialogue.filter(d => d.speaker === 'B').length;
            document.getElementById('score').textContent = state.score;
        }
        
        function backToScenarios() {
            document.getElementById('complete-screen').style.display = 'none';
            document.getElementById('scenario-screen').style.display = 'block';
        }
        
        function replayScenario() {
            document.getElementById('complete-screen').style.display = 'none';
            selectScenario(state.scenario);
        }
        
        function speak(text) {
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'zh-CN'; u.rate = 0.8;
            speechSynthesis.speak(u);
        }
        
        renderScenarios();
    </script>
</body>
</html>

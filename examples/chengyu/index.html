<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolyBiz AI - Chengyu Game ÊàêËØ≠Â≠¶‰π†</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh; color: #fff; padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #888; margin-bottom: 20px; }
        .card {
            background: rgba(255,255,255,0.05); border-radius: 15px;
            padding: 25px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab {
            flex: 1; padding: 12px; border: none; border-radius: 10px;
            background: rgba(255,255,255,0.05); color: #888;
            cursor: pointer; transition: all 0.2s;
        }
        .tab:hover { background: rgba(255,255,255,0.1); }
        .tab.active { background: rgba(59,130,246,0.3); color: #fff; }
        /* Chengyu Card */
        .chengyu-display {
            text-align: center; padding: 30px;
            background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(59,130,246,0.2));
            border-radius: 15px; margin-bottom: 20px;
        }
        .chengyu-chars {
            font-size: 4em; font-family: 'Noto Sans SC', serif;
            letter-spacing: 10px; margin-bottom: 15px;
        }
        .chengyu-pinyin { color: #fbbf24; font-size: 1.3em; margin-bottom: 10px; }
        .chengyu-meaning { color: #aaa; font-size: 1.1em; margin-bottom: 15px; }
        .chengyu-story {
            text-align: left; padding: 15px; background: rgba(0,0,0,0.2);
            border-radius: 10px; color: #888; line-height: 1.6;
        }
        .chengyu-story h4 { color: #fbbf24; margin-bottom: 10px; }
        /* Quiz */
        .quiz-question { font-size: 1.2em; margin-bottom: 20px; text-align: center; }
        .quiz-chars {
            font-size: 3em; letter-spacing: 8px; margin: 20px 0;
            font-family: 'Noto Sans SC', serif;
        }
        .quiz-chars .blank {
            display: inline-block; width: 60px; height: 70px;
            border-bottom: 3px dashed #60a5fa; margin: 0 5px;
            vertical-align: bottom;
        }
        .options-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
        }
        .char-option {
            padding: 20px; font-size: 2em; border: 2px solid #333;
            border-radius: 12px; cursor: pointer; transition: all 0.2s;
            text-align: center; font-family: 'Noto Sans SC', serif;
        }
        .char-option:hover { border-color: #60a5fa; background: rgba(96,165,250,0.1); }
        .char-option.correct { border-color: #22c55e; background: rgba(34,197,94,0.2); }
        .char-option.wrong { border-color: #ef4444; background: rgba(239,68,68,0.2); }
        /* List */
        .chengyu-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .chengyu-item {
            padding: 15px; background: rgba(255,255,255,0.03);
            border-radius: 12px; cursor: pointer; transition: all 0.2s;
        }
        .chengyu-item:hover { background: rgba(255,255,255,0.08); }
        .item-chars { font-size: 1.5em; margin-bottom: 5px; }
        .item-pinyin { color: #fbbf24; font-size: 0.85em; }
        .item-meaning { color: #888; font-size: 0.8em; margin-top: 5px; }
        .btn {
            padding: 12px 25px; border: none; border-radius: 10px;
            cursor: pointer; font-size: 14px; transition: all 0.2s;
        }
        .btn-primary { background: #3b82f6; color: #fff; }
        .btn-success { background: #22c55e; color: #fff; }
        .btn:hover { transform: scale(1.05); }
        .stats-bar {
            display: flex; justify-content: space-around; padding: 15px;
            background: rgba(0,0,0,0.3); border-radius: 10px; margin-bottom: 20px;
        }
        .stat-item { text-align: center; }
        .stat-value { font-size: 1.5em; font-weight: bold; color: #60a5fa; }
        .stat-label { font-size: 0.8em; color: #888; }
        .nav-btns { display: flex; justify-content: space-between; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÆ Chengyu Game ÊàêËØ≠Â≠¶‰π†</h1>
        <p class="subtitle">H·ªçc th√†nh ng·ªØ Trung Qu·ªëc qua c√¢u chuy·ªán</p>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('learn')">üìñ H·ªçc</button>
            <button class="tab" onclick="switchTab('quiz')">üéØ Quiz</button>
            <button class="tab" onclick="switchTab('list')">üìã Danh s√°ch</button>
        </div>
        
        <!-- Learn Tab -->
        <div id="learn-tab">
            <div class="card">
                <div class="chengyu-display">
                    <div class="chengyu-chars" id="learn-chars">‰∏ÄÁü≥‰∫åÈ∏ü</div>
                    <div class="chengyu-pinyin" id="learn-pinyin">yƒ´ sh√≠ √®r ni«éo</div>
                    <div class="chengyu-meaning" id="learn-meaning">M·ªôt m≈©i t√™n tr√∫ng hai ƒë√≠ch</div>
                    <button class="btn btn-primary" style="margin-top:15px;" onclick="speakChengyu()">üîä Nghe</button>
                </div>
                <div class="chengyu-story" id="learn-story">
                    <h4>üìú C√¢u chuy·ªán</h4>
                    <p id="story-text"></p>
                </div>
                <div class="nav-btns">
                    <button class="btn btn-primary" onclick="prevChengyu()">‚Üê Tr∆∞·ªõc</button>
                    <span id="learn-progress" style="color:#888;">1/20</span>
                    <button class="btn btn-primary" onclick="nextChengyu()">Ti·∫øp ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- Quiz Tab -->
        <div id="quiz-tab" style="display:none;">
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="quiz-score">0</div>
                    <div class="stat-label">ƒêi·ªÉm</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="quiz-streak">0 üî•</div>
                    <div class="stat-label">Streak</div>
                </div>
            </div>
            <div class="card">
                <div class="quiz-question" id="quiz-question">ƒêi·ªÅn ch·ªØ c√≤n thi·∫øu:</div>
                <div class="quiz-chars" id="quiz-chars"></div>
                <div class="chengyu-meaning" id="quiz-hint" style="text-align:center;margin-bottom:20px;"></div>
                <div class="options-grid" id="quiz-options"></div>
                <div style="text-align:center;margin-top:20px;">
                    <button class="btn btn-success" id="btn-next-quiz" onclick="nextQuiz()" style="display:none;">Ti·∫øp theo ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- List Tab -->
        <div id="list-tab" style="display:none;">
            <div class="card">
                <div class="chengyu-list" id="chengyu-list"></div>
            </div>
        </div>
    </div>

    <script>
        const CHENGYU = [
            { chars: '‰∏ÄÁü≥‰∫åÈ∏ü', pinyin: 'yƒ´ sh√≠ √®r ni«éo', meaning: 'M·ªôt m≈©i t√™n tr√∫ng hai ƒë√≠ch', story: 'Th√†nh ng·ªØ n√†y c√≥ ngu·ªìn g·ªëc t·ª´ ph∆∞∆°ng T√¢y, √Ω ch·ªâ l√†m m·ªôt vi·ªác m√† ƒë·∫°t ƒë∆∞·ª£c hai m·ª•c ƒë√≠ch. Gi·ªëng nh∆∞ n√©m m·ªôt h√≤n ƒë√° m√† b·∫Øn tr√∫ng hai con chim.' },
            { chars: 'ÁîªËõáÊ∑ªË∂≥', pinyin: 'hu√† sh√© tiƒÅn z√∫', meaning: 'V·∫Ω r·∫Øn th√™m ch√¢n (l√†m th·ª´a)', story: 'X∆∞a c√≥ cu·ªôc thi v·∫Ω r·∫Øn, ai xong tr∆∞·ªõc ƒë∆∞·ª£c u·ªëng r∆∞·ª£u. M·ªôt ng∆∞·ªùi v·∫Ω xong s·ªõm, th·∫•y c√≤n th·ªùi gian b√®n v·∫Ω th√™m ch√¢n cho r·∫Øn, k·∫øt qu·∫£ b·ªã lo·∫°i v√¨ r·∫Øn kh√¥ng c√≥ ch√¢n.' },
            { chars: 'ÂØπÁâõÂºπÁê¥', pinyin: 'du√¨ ni√∫ t√°n q√≠n', meaning: 'ƒê√†n g·∫£y tai tr√¢u', story: 'C√≥ ng∆∞·ªùi ch∆°i ƒë√†n hay, m·ªôt h√¥m g·∫£y ƒë√†n cho tr√¢u nghe. Tr√¢u v·∫´n c√∫i ƒë·∫ßu ƒÉn c·ªè, kh√¥ng quan t√¢m. √ù ch·ªâ n√≥i v·ªõi ng∆∞·ªùi kh√¥ng hi·ªÉu, ph√≠ c√¥ng v√¥ √≠ch.' },
            { chars: 'ÂÆàÊ†™ÂæÖÂÖî', pinyin: 'sh«íu zh≈´ d√†i t√π', meaning: '√îm c√¢y ƒë·ª£i th·ªè', story: 'M·ªôt n√¥ng d√¢n th·∫•y con th·ªè ch·∫°y ƒë√¢m v√†o g·ªëc c√¢y ch·∫øt. T·ª´ ƒë√≥ anh ta b·ªè c√†y ru·ªông, ng·ªìi ƒë·ª£i th·ªè kh√°c ƒë√¢m v√†o c√¢y. √ù ch·ªâ ng∆∞·ªùi ch·ªù may m·∫Øn m√† kh√¥ng ch·ªãu l√†m vi·ªác.' },
            { chars: '‰∫°ÁæäË°•Áâ¢', pinyin: 'w√°ng y√°ng b«î l√°o', meaning: 'M·∫•t b√≤ m·ªõi lo l√†m chu·ªìng', story: 'M·ªôt ng∆∞·ªùi m·∫•t d√™ v√¨ chu·ªìng th·ªßng, h√†ng x√≥m khuy√™n s·ª≠a chu·ªìng nh∆∞ng kh√¥ng nghe. M·∫•t th√™m d√™ n·ªØa m·ªõi ch·ªãu s·ª≠a. √ù ch·ªâ s·ª≠a sai khi c√≤n k·ªãp.' },
            { chars: 'Êé©ËÄ≥ÁõóÈìÉ', pinyin: 'y«én ƒõr d√†o l√≠ng', meaning: 'B·ªãt tai ƒÉn tr·ªôm chu√¥ng', story: 'C√≥ k·∫ª mu·ªën ƒÉn tr·ªôm chu√¥ng, s·ª£ ti·∫øng chu√¥ng k√™u n√™n b·ªãt tai m√¨nh l·∫°i r·ªìi l·∫•y. √ù ch·ªâ t·ª± l·ª´a d·ªëi b·∫£n th√¢n.' },
            { chars: '‰∫ïÂ∫ï‰πãËõô', pinyin: 'j«êng d«ê zhƒ´ wƒÅ', meaning: '·∫æch ng·ªìi ƒë√°y gi·∫øng', story: 'Con ·∫øch s·ªëng trong gi·∫øng, nghƒ© b·∫ßu tr·ªùi ch·ªâ to b·∫±ng mi·ªáng gi·∫øng. Khi r√πa bi·ªÉn k·ªÉ v·ªÅ ƒë·∫°i d∆∞∆°ng, ·∫øch kh√¥ng tin. √ù ch·ªâ ng∆∞·ªùi hi·ªÉu bi·∫øt h·∫°n h·∫πp.' },
            { chars: 'ÁãêÂÅáËôéÂ®Å', pinyin: 'h√∫ ji«é h«î wƒìi', meaning: 'C√°o m∆∞·ª£n oai h√πm', story: 'C√°o b·ªã h·ªï b·∫Øt, n√≥i m√¨nh l√† vua mu√¥ng th√∫. H·ªï kh√¥ng tin, c√°o b·∫£o ƒëi theo s·∫Ω th·∫•y. C√°c con v·∫≠t th·∫•y h·ªï ƒë·ªÅu ch·∫°y, c√°o n√≥i ƒë√≥ l√† s·ª£ m√¨nh. √ù ch·ªâ m∆∞·ª£n th·∫ø ng∆∞·ªùi kh√°c.' },
            { chars: 'Â°ûÁøÅÂ§±È©¨', pinyin: 's√†i wƒìng shƒ´ m«é', meaning: 'T√°i √¥ng m·∫•t ng·ª±a', story: '√îng gi√† bi√™n gi·ªõi m·∫•t ng·ª±a, m·ªçi ng∆∞·ªùi an ·ªßi, √¥ng n√≥i bi·∫øt ƒë√¢u l√† ph√∫c. Ng·ª±a quay v·ªÅ d·∫´n theo ng·ª±a hay. Con trai c∆∞·ª°i ng·ª±a ng√£ g√£y ch√¢n, tho√°t ƒë∆∞·ª£c ƒëi l√≠nh. √ù ch·ªâ h·ªça ph√∫c kh√≥ l∆∞·ªùng.' },
            { chars: 'ÊùØÂºìËõáÂΩ±', pinyin: 'bƒìi g≈çng sh√© y«êng', meaning: 'B√≥ng cung trong ch√©n', story: 'C√≥ ng∆∞·ªùi u·ªëng r∆∞·ª£u th·∫•y b√≥ng r·∫Øn trong ch√©n, v·ªÅ nh√† ·ªëm n·∫∑ng. Sau bi·∫øt ƒë√≥ ch·ªâ l√† b√≥ng c√¢y cung treo tr√™n t∆∞·ªùng. √ù ch·ªâ nghi ng·ªù v√¥ cƒÉn c·ª©.' },
            { chars: 'ÂàªËàüÊ±ÇÂâë', pinyin: 'k√® zh≈çu qi√∫ ji√†n', meaning: 'Kh·∫Øc thuy·ªÅn t√¨m ki·∫øm', story: 'C√≥ ng∆∞·ªùi ƒë√°nh r∆°i ki·∫øm xu·ªëng s√¥ng, li·ªÅn kh·∫Øc d·∫•u tr√™n thuy·ªÅn. Thuy·ªÅn c·∫≠p b·∫øn, anh ta nh·∫£y xu·ªëng ch·ªó kh·∫Øc d·∫•u t√¨m ki·∫øm. √ù ch·ªâ ng∆∞·ªùi c·ª©ng nh·∫Øc, kh√¥ng bi·∫øt thay ƒë·ªïi.' },
            { chars: 'Âè∂ÂÖ¨Â•ΩÈæô', pinyin: 'y√® g≈çng h√†o l√≥ng', meaning: 'Di·ªáp C√¥ng th√≠ch r·ªìng', story: 'Di·ªáp C√¥ng th√≠ch r·ªìng, v·∫Ω r·ªìng kh·∫Øp nh√†. R·ªìng th·∫≠t nghe ti·∫øng ƒë·∫øn thƒÉm, Di·ªáp C√¥ng s·ª£ h√£i b·ªè ch·∫°y. √ù ch·ªâ ng∆∞·ªùi ch·ªâ th√≠ch b·ªÅ ngo√†i, kh√¥ng th√≠ch th·ª±c ch·∫•t.' },
            { chars: 'Áè≠Èó®ÂºÑÊñß', pinyin: 'bƒÅn m√©n n√≤ng f«î', meaning: 'M√∫a r√¨u qua m·∫Øt th·ª£', story: 'L·ªó Ban l√† th·ª£ m·ªôc gi·ªèi nh·∫•t. Ai m√∫a r√¨u tr∆∞·ªõc c·ª≠a nh√† √¥ng ·∫•y l√† t·ª± khoe khoang tr∆∞·ªõc ng∆∞·ªùi gi·ªèi h∆°n m√¨nh.' },
            { chars: 'Á†¥ÈáúÊ≤âËàü', pinyin: 'p√≤ f«î ch√©n zh≈çu', meaning: 'ƒê·∫≠p n·ªìi ƒë·∫Øm thuy·ªÅn', story: 'H·∫°ng V≈© d·∫´n qu√¢n qua s√¥ng, ra l·ªánh ƒë·∫≠p h·∫øt n·ªìi, ƒë·∫Øm thuy·ªÅn, ch·ªâ mang l∆∞∆°ng 3 ng√†y. Qu√¢n sƒ© bi·∫øt kh√¥ng c√≤n ƒë∆∞·ªùng lui, chi·∫øn ƒë·∫•u h·∫øt m√¨nh v√† th·∫Øng l·ª£i.' },
            { chars: 'ÂçßËñ™Â∞ùËÉÜ', pinyin: 'w√≤ xƒ´n ch√°ng d«én', meaning: 'N·∫±m gai n·∫øm m·∫≠t', story: 'Vi·ªát V∆∞∆°ng C√¢u Ti·ªÖn b·∫°i tr·∫≠n, ph·∫£i h·∫ßu h·∫° Ng√¥ V∆∞∆°ng. V·ªÅ n∆∞·ªõc, √¥ng n·∫±m tr√™n c·ªßi, m·ªói ng√†y n·∫øm m·∫≠t ƒë·∫Øng ƒë·ªÉ nh·ªõ n·ªói nh·ª•c. Sau 10 nƒÉm, √¥ng di·ªát ƒë∆∞·ª£c n∆∞·ªõc Ng√¥.' },
            { chars: 'Á∫∏‰∏äË∞àÂÖµ', pinyin: 'zh«ê sh√†ng t√°n bƒ´ng', meaning: 'B√†n binh tr√™n gi·∫•y', story: 'Tri·ªáu Qu√°t ƒë·ªçc nhi·ªÅu binh th∆∞, n√≥i chuy·ªán qu√¢n s·ª± r·∫•t hay. Nh∆∞ng khi th·ª±c chi·∫øn, √¥ng th·∫•t b·∫°i th·∫£m h·∫°i v√¨ ch·ªâ bi·∫øt l√Ω thuy·∫øt.' },
            { chars: 'ÁîªÈæôÁÇπÁùõ', pinyin: 'hu√† l√≥ng di«én jƒ´ng', meaning: 'V·∫Ω r·ªìng ƒëi·ªÉm m·∫Øt', story: 'H·ªça sƒ© Tr∆∞∆°ng TƒÉng Dao v·∫Ω 4 con r·ªìng nh∆∞ng kh√¥ng v·∫Ω m·∫Øt. Khi b·ªã √©p v·∫Ω m·∫Øt cho 2 con, ch√∫ng bay l√™n tr·ªùi. √ù ch·ªâ th√™m chi ti·∫øt quan tr·ªçng l√†m ho√†n h·∫£o t√°c ph·∫©m.' },
            { chars: 'ÊÑöÂÖ¨ÁßªÂ±±', pinyin: 'y√∫ g≈çng y√≠ shƒÅn', meaning: 'Ngu C√¥ng d·ªùi n√∫i', story: 'Ngu C√¥ng 90 tu·ªïi quy·∫øt d·ªùi 2 ng·ªçn n√∫i ch·∫Øn ƒë∆∞·ªùng. M·ªçi ng∆∞·ªùi c∆∞·ªùi, √¥ng n√≥i con ch√°u s·∫Ω ti·∫øp t·ª•c. Tr·ªùi c·∫£m ƒë·ªông, sai th·∫ßn d·ªùi n√∫i ƒëi. √ù ch·ªâ ki√™n tr√¨ s·∫Ω th√†nh c√¥ng.' },
            { chars: 'Ëá™Áõ∏ÁüõÁõæ', pinyin: 'z√¨ xiƒÅng m√°o d√πn', meaning: 'T·ª± m√¢u thu·∫´n', story: 'C√≥ ng∆∞·ªùi b√°n gi√°o v√† khi√™n. Khoe gi√°o ƒë√¢m th·ªßng m·ªçi th·ª©, khi√™n ch·∫Øn ƒë∆∞·ª£c m·ªçi th·ª©. C√≥ ng∆∞·ªùi h·ªèi l·∫•y gi√°o ƒë√¢m khi√™n th√¨ sao? Ng∆∞·ªùi b√°n kh√¥ng tr·∫£ l·ªùi ƒë∆∞·ª£c.' },
            { chars: '‰∏â‰∫∫ÊàêËôé', pinyin: 'sƒÅn r√©n ch√©ng h«î', meaning: 'Ba ng∆∞·ªùi th√†nh h·ªï', story: 'C√≥ ng∆∞·ªùi h·ªèi vua: M·ªôt ng∆∞·ªùi n√≥i c√≥ h·ªï ·ªü ch·ª£, vua c√≥ tin kh√¥ng? Vua n√≥i kh√¥ng. Hai ng∆∞·ªùi n√≥i? V·∫´n kh√¥ng. Ba ng∆∞·ªùi n√≥i? Vua n√≥i s·∫Ω tin. √ù ch·ªâ tin ƒë·ªìn lan r·ªông th√†nh s·ª± th·∫≠t.' },
        ];
        
        let state = { learnIndex: 0, quizIndex: 0, score: 0, streak: 0, answered: false };
        
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            document.getElementById('learn-tab').style.display = tab === 'learn' ? 'block' : 'none';
            document.getElementById('quiz-tab').style.display = tab === 'quiz' ? 'block' : 'none';
            document.getElementById('list-tab').style.display = tab === 'list' ? 'block' : 'none';
            if (tab === 'quiz') startQuiz();
            if (tab === 'list') renderList();
        }
        
        function renderLearn() {
            const c = CHENGYU[state.learnIndex];
            document.getElementById('learn-chars').textContent = c.chars;
            document.getElementById('learn-pinyin').textContent = c.pinyin;
            document.getElementById('learn-meaning').textContent = c.meaning;
            document.getElementById('story-text').textContent = c.story;
            document.getElementById('learn-progress').textContent = `${state.learnIndex + 1}/${CHENGYU.length}`;
        }
        
        function prevChengyu() {
            state.learnIndex = (state.learnIndex - 1 + CHENGYU.length) % CHENGYU.length;
            renderLearn();
        }
        
        function nextChengyu() {
            state.learnIndex = (state.learnIndex + 1) % CHENGYU.length;
            renderLearn();
        }
        
        function speakChengyu() {
            const u = new SpeechSynthesisUtterance(CHENGYU[state.learnIndex].chars);
            u.lang = 'zh-CN'; u.rate = 0.7;
            speechSynthesis.speak(u);
        }
        
        function startQuiz() {
            state.quizIndex = 0; state.score = 0; state.streak = 0;
            renderQuiz();
        }
        
        function renderQuiz() {
            state.answered = false;
            const c = CHENGYU[Math.floor(Math.random() * CHENGYU.length)];
            const blankPos = Math.floor(Math.random() * 4);
            const correctChar = c.chars[blankPos];
            
            let display = '';
            for (let i = 0; i < 4; i++) {
                display += i === blankPos ? '<span class="blank"></span>' : c.chars[i];
            }
            document.getElementById('quiz-chars').innerHTML = display;
            document.getElementById('quiz-hint').textContent = 'üí° ' + c.meaning;
            
            // Generate options
            const options = [correctChar];
            while (options.length < 4) {
                const randC = CHENGYU[Math.floor(Math.random() * CHENGYU.length)];
                const randChar = randC.chars[Math.floor(Math.random() * 4)];
                if (!options.includes(randChar)) options.push(randChar);
            }
            options.sort(() => Math.random() - 0.5);
            
            document.getElementById('quiz-options').innerHTML = options.map(o => `
                <div class="char-option" data-char="${o}" data-correct="${o === correctChar}" onclick="selectQuizOption(this, '${correctChar}')">
                    ${o}
                </div>
            `).join('');
            
            document.getElementById('btn-next-quiz').style.display = 'none';
            updateQuizStats();
        }
        
        function selectQuizOption(el, correct) {
            if (state.answered) return;
            state.answered = true;
            
            const isCorrect = el.dataset.char === correct;
            document.querySelectorAll('.char-option').forEach(opt => {
                if (opt.dataset.char === correct) opt.classList.add('correct');
                else if (opt === el) opt.classList.add('wrong');
            });
            
            document.querySelector('.blank').textContent = correct;
            
            if (isCorrect) { state.score++; state.streak++; }
            else { state.streak = 0; }
            
            updateQuizStats();
            document.getElementById('btn-next-quiz').style.display = 'inline-block';
        }
        
        function nextQuiz() { renderQuiz(); }
        
        function updateQuizStats() {
            document.getElementById('quiz-score').textContent = state.score;
            document.getElementById('quiz-streak').textContent = state.streak + ' üî•';
        }
        
        function renderList() {
            document.getElementById('chengyu-list').innerHTML = CHENGYU.map((c, i) => `
                <div class="chengyu-item" onclick="state.learnIndex=${i};switchTab('learn');">
                    <div class="item-chars">${c.chars}</div>
                    <div class="item-pinyin">${c.pinyin}</div>
                    <div class="item-meaning">${c.meaning}</div>
                </div>
            `).join('');
        }
        
        renderLearn();
    </script>
</body>
</html>
